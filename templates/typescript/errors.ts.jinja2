/**
 * Error classes for {{ api_name }} SDK
 * Generated by API SDK Generator
 */

/**
 * Base error class for all API errors
 */
export class APIError extends Error {
  public readonly statusCode?: number;
  public readonly originalError?: Error;
  public readonly timestamp: Date;
  public readonly requestInfo?: {
    method: string;
    url: string;
    headers?: Record<string, string>;
  };

  constructor(
    message: string,
    statusCode?: number,
    originalError?: Error,
    requestInfo?: any
  ) {
    super(message);
    this.name = 'APIError';
    this.statusCode = statusCode;
    this.originalError = originalError;
    this.timestamp = new Date();
    this.requestInfo = requestInfo;

    // Maintains proper stack trace for where our error was thrown (only available on V8)
    if (Error.captureStackTrace) {
      Error.captureStackTrace(this, this.constructor);
    }
  }
}

/**
 * Network-related errors (connection failures, timeouts)
 */
export class NetworkError extends APIError {
  constructor(message: string, originalError?: Error, requestInfo?: any) {
    super(message, undefined, originalError, requestInfo);
    this.name = 'NetworkError';
  }
}

/**
 * Rate limit exceeded error (HTTP 429)
 */
export class RateLimitError extends APIError {
  public readonly retryAfter?: number; // Seconds to wait before retrying

  constructor(
    message: string,
    retryAfter?: number,
    requestInfo?: any
  ) {
    super(message, 429, undefined, requestInfo);
    this.name = 'RateLimitError';
    this.retryAfter = retryAfter;
  }
}

/**
 * Authentication/Authorization errors (HTTP 401, 403)
 */
export class AuthenticationError extends APIError {
  constructor(message: string, statusCode: number, requestInfo?: any) {
    super(message, statusCode, undefined, requestInfo);
    this.name = 'AuthenticationError';
  }
}

/**
 * Validation error (HTTP 400)
 */
export class ValidationError extends APIError {
  public readonly validationDetails?: any;

  constructor(
    message: string,
    validationDetails?: any,
    requestInfo?: any
  ) {
    super(message, 400, undefined, requestInfo);
    this.name = 'ValidationError';
    this.validationDetails = validationDetails;
  }
}

/**
 * Resource not found error (HTTP 404)
 */
export class NotFoundError extends APIError {
  constructor(message: string, requestInfo?: any) {
    super(message, 404, undefined, requestInfo);
    this.name = 'NotFoundError';
  }
}

/**
 * Server error (HTTP 500+)
 */
export class ServerError extends APIError {
  constructor(message: string, statusCode: number, requestInfo?: any) {
    super(message, statusCode, undefined, requestInfo);
    this.name = 'ServerError';
  }
}

/**
 * Helper function to create appropriate error based on status code
 */
export function createErrorFromResponse(
  statusCode: number,
  message: string,
  requestInfo?: any
): APIError {
  if (statusCode === 400) {
    return new ValidationError(message, undefined, requestInfo);
  } else if (statusCode === 401 || statusCode === 403) {
    return new AuthenticationError(message, statusCode, requestInfo);
  } else if (statusCode === 404) {
    return new NotFoundError(message, requestInfo);
  } else if (statusCode === 429) {
    return new RateLimitError(message, undefined, requestInfo);
  } else if (statusCode >= 500) {
    return new ServerError(message, statusCode, requestInfo);
  } else {
    return new APIError(message, statusCode, undefined, requestInfo);
  }
}
